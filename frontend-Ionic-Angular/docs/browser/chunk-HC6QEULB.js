import{a as y}from"./chunk-5W6OI3HN.js";import{a as D}from"./chunk-FRM2HGHV.js";import{a as N}from"./chunk-PKOGN4VO.js";import{a as ge}from"./chunk-GJZEQUDA.js";import{a as ve,c as Ie}from"./chunk-K4MEQIZ7.js";import{$ as ie,A as I,C as A,Ca as pe,D as G,Da as L,E as H,Ga as ue,Ha as fe,Ia as B,J as Z,K as g,Ka as he,L as $,N as C,Na as _e,Oa as V,Pa as W,V as M,W as b,X as ee,Y as te,Z as P,_ as oe,aa as ne,ba as re,ca as S,da as le,f as J,g as K,i as m,j as s,ja as R,k as h,ka as ae,l as _,la as x,m as d,ma as T,na as w,oa as k,pa as me,q as l,qa as O,r,s as v,sa as se,t as Q,ta as ce,u as f,ua as j,v as F,w as X,wa as de,x as Y,y as a}from"./chunk-BR66K6D3.js";import"./chunk-IPXLKNFD.js";import"./chunk-7KGURMOZ.js";import"./chunk-ZYUIEBGB.js";import"./chunk-5Z6BILBO.js";import"./chunk-ETSLECS3.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-C3VUKG7J.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as E,b as U,f as z}from"./chunk-RW4GY4BD.js";function Fe(n,o){if(n&1&&(l(0,"ion-select-option",8),a(1),r()),n&2){let p=o.$implicit;d("value",p.departmentID),m(),I(" ",p.departmentName," ")}}var Ne=(()=>{let o=class o{constructor(t,e,i){this._roleService=t,this._departmentService=e,this._toastService=i,this.departments=[],this.roleForm=new te({roleName:new P("",[M.required,M.minLength(2),M.maxLength(50)]),departmentID:new P(null,M.required)})}ngOnInit(){this.getDepartments(),this.capitalizeRoleName()}getDepartments(){this.departments=this._departmentService.getDepartments()}onSubmit(){if(this.roleForm.valid){let t=U(E({},this.roleForm.value),{departmentID:Number(this.roleForm.value.departmentID)});this._roleService.checkDuplicates(t)?this._toastService.presentErrorToast("Role already exists."):(this._roleService.addRole(t),this.roleForm.reset(),this._roleService.notifyRolesChanged(),this._toastService.presentSuccessToast("Role created."))}else this._toastService.presentErrorToast("Role failed to be created.")}capitalizeRoleName(){var t;(t=this.roleForm.get("roleName"))==null||t.valueChanges.subscribe(e=>{var i;e&&((i=this.roleForm.get("roleName"))==null||i.setValue(e.toUpperCase(),{emitEvent:!1}))})}};o.\u0275fac=function(e){return new(e||o)(s(D),s(y),s(N))},o.\u0275cmp=h({type:o,selectors:[["app-role-create"]],decls:13,vars:3,consts:[[1,"ion-card"],[1,"ion-text-center"],[3,"ngSubmit","formGroup"],["id","departmentID","formControlName","departmentID","placeholder","Select a Department"],["slot","label"],[3,"value",4,"ngFor","ngForOf"],["id","roleName","label","Role Name","formControlName","roleName","placeholder","Enter Role Name"],["expand","block","type","submit",3,"click","disabled"],[3,"value"]],template:function(e,i){e&1&&(l(0,"ion-card",0)(1,"ion-card-header",1)(2,"ion-card-title"),a(3," Add New Role "),r()(),l(4,"ion-card-content")(5,"form",2),f("ngSubmit",function(){return i.onSubmit()}),l(6,"ion-select",3)(7,"div",4),a(8,"Department"),r(),_(9,Fe,2,2,"ion-select-option",5),r(),v(10,"ion-input",6),l(11,"ion-button",7),f("click",function(){return i.onSubmit()}),a(12," Add Role "),r()()()()),e&2&&(m(5),d("formGroup",i.roleForm),m(4),d("ngForOf",i.departments),m(2),d("disabled",i.roleForm.invalid))},dependencies:[C,g,S,ie,b,ee,le,ne,re,x,w,k,T,V,R,W,L],encapsulation:2});let n=o;return n})();function xe(n,o){if(n&1&&(l(0,"ion-select-option",9),a(1),r()),n&2){let p=o.$implicit;d("value",p.departmentID),m(),I(" ",p.departmentName," ")}}var ye=(()=>{let o=class o{constructor(t,e,i,c){this.modalCtrl=t,this._departmentService=e,this._roleService=i,this._toastService=c,this.roleID=-1,this.departments=[],this.originalRole={roleID:-1,roleName:"",departmentID:-1},this.editedRole={roleID:-1,roleName:"",departmentID:-1}}ngOnInit(){this.getRole(),this.departments=this._departmentService.getDepartments()}getRole(){let t=this._roleService.getRole(this.roleID);if(!t){console.error("Role not found"),this.modalCtrl.dismiss(null,"error");return}this.originalRole=E({},t),this.editedRole=E({},t)}cancel(){return this.modalCtrl.dismiss(null,"cancel")}confirm(){return this.saveChanges(),this.modalCtrl.dismiss(this.roleID,"confirm")}saveChanges(){this._roleService.updateRole(this.editedRole),this._roleService.notifyRolesChanged(),this._toastService.presentSuccessToast("Role saved.")}onRoleNameInput(t){let e=t.target;e!=null&&e.value&&(this.editedRole.roleName=e.value.toUpperCase())}};o.\u0275fac=function(e){return new(e||o)(s(B),s(y),s(D),s(N))},o.\u0275cmp=h({type:o,selectors:[["app-role-edit-modal"]],inputs:{roleID:"roleID"},decls:19,vars:5,consts:[["slot","start"],["color","medium",3,"click"],["slot","end"],[3,"click","strong"],[1,"ion-padding"],["label","Role Name:",3,"ionInput","ngModelChange","value","ngModel"],["placeholder","Select a Department",3,"ngModelChange","ngModel"],["slot","label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,i){e&1&&(l(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),f("click",function(){return i.cancel()}),a(4,"Cancel"),r()(),l(5,"ion-title"),a(6,"Edit Role"),r(),l(7,"ion-buttons",2)(8,"ion-button",3),f("click",function(){return i.confirm()}),a(9,"Confirm"),r()()()(),l(10,"ion-content",4)(11,"ion-item")(12,"ion-input",5),f("ionInput",function(u){return i.onRoleNameInput(u)}),H("ngModelChange",function(u){return G(i.editedRole.roleName,u)||(i.editedRole.roleName=u),u}),r()(),l(13,"ion-item")(14,"ion-select",6),H("ngModelChange",function(u){return G(i.editedRole.departmentID,u)||(i.editedRole.departmentID=u),u}),a(15," > "),l(16,"div",7),a(17,"Department"),r(),_(18,xe,2,2,"ion-select-option",8),r()()()),e&2&&(m(8),d("strong",!0),m(4),X("value",i.editedRole.roleName),A("ngModel",i.editedRole.roleName),m(2),A("ngModel",i.editedRole.departmentID),m(4),d("ngForOf",i.departments))},dependencies:[C,g,S,b,oe,R,ae,O,ce,j,ue,fe,V,W,L],encapsulation:2});let n=o;return n})();function Te(n,o){if(n&1){let p=Q();l(0,"ion-item")(1,"ion-grid")(2,"ion-row")(3,"ion-col",6),a(4),r(),l(5,"ion-col",6),a(6),r(),l(7,"ion-col",7)(8,"ion-button",8),f("click",function(){let e=J(p).$implicit,i=F(2);return K(i.presentRoleActionSheet(e))}),v(9,"ion-icon",9),r()()()()()}if(n&2){let p=o.$implicit,t=F(2);m(4),I(" ",p.roleName," "),m(2),I(" ",t.getDepartmentName(p.departmentID)," ")}}function we(n,o){if(n&1&&(l(0,"ion-list")(1,"ion-item")(2,"ion-grid")(3,"ion-row")(4,"ion-col",4),a(5,"Role Name"),r(),l(6,"ion-col",4),a(7,"Department"),r()()()(),_(8,Te,10,2,"ion-item",5),r()),n&2){let p=F();m(8),d("ngForOf",p.roles)}}function ke(n,o){n&1&&a(0," No Roles ")}var Ee=(()=>{let o=class o{constructor(t,e,i,c,u){this._departmentService=t,this._roleService=e,this.actionSheetCtrl=i,this.modalCtrl=c,this._toastService=u,this.roles=[],this.departments=[],this.editModeRoleId=null,ve({ellipsisVerticalSharp:Ie})}ngOnInit(){this.loadDepartments(),this.loadRoles()}loadDepartments(){this.departments=this._departmentService.getDepartments()}loadRoles(){this.roles=this._roleService.getRoles()}getDepartmentName(t){let e=this.departments.find(i=>i.departmentID==t);return e?e.departmentName:void 0}presentRoleActionSheet(t){return z(this,null,function*(){yield(yield this.actionSheetCtrl.create({header:t.roleName,buttons:[{text:"Edit",handler:()=>this.openEmployeeEditModal(t.roleID)},{text:"Delete",role:"destructive",handler:()=>this.onDelete(t.roleID)},{text:"Cancel",role:"cancel",data:{action:"cancel"}}]})).present()})}openEmployeeEditModal(t){return z(this,null,function*(){let e=yield this.modalCtrl.create({component:ye,componentProps:{roleID:t}});e.present();let{data:i,role:c}=yield e.onWillDismiss();c==="confirm"&&this.loadRoles()})}onDelete(t){confirm("Are you sure you want to delete this role?")&&(this._roleService.deleteRole(t),this.loadRoles(),this._toastService.presentSuccessToast("Role deleted."))}};o.\u0275fac=function(e){return new(e||o)(s(y),s(D),s(he),s(B),s(N))},o.\u0275cmp=h({type:o,selectors:[["app-role-list"]],decls:8,vars:2,consts:[["noRolesBlock",""],[1,"ion-card"],[1,"ion-text-center"],[4,"ngIf","ngIfElse"],["size","5"],[4,"ngFor","ngForOf"],["size","5",1,"ion-align-self-center"],["size","2"],["fill","clear","size","small",3,"click"],["slot","icon-only","name","ellipsis-vertical-sharp"]],template:function(e,i){if(e&1&&(l(0,"ion-card",1)(1,"ion-card-header",2)(2,"ion-card-title"),a(3," Role List "),r()(),l(4,"ion-card-content"),_(5,we,9,1,"ion-list",3)(6,ke,1,0,"ng-template",null,0,Z),r()()),e&2){let c=Y(7);m(5),d("ngIf",i.roles.length>0)("ngIfElse",c)}},dependencies:[C,g,$,S,x,w,k,T,de,j,R,_e,se,pe,me],encapsulation:2});let n=o;return n})();var ot=(()=>{let o=class o{constructor(){}};o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=h({type:o,selectors:[["app-roles"]],decls:4,vars:1,consts:[[3,"title"],[1,"ion-padding"]],template:function(e,i){e&1&&(v(0,"app-sidemenu",0),l(1,"ion-content",1),v(2,"app-role-create")(3,"app-role-list"),r()),e&2&&d("title","Roles")},dependencies:[ge,O,Ne,Ee],encapsulation:2});let n=o;return n})();export{ot as RolesComponent};
